EXCEL AND DATA CLEANUP
==========================

DATA SOURCES:
https://www.nj.com/education/2018/03/heres_how_every_nj_high_school_fared_on_the_sat.html#incart_2box_nj-homepage-featured
https://www.nj.gov/education/stateaid/1617/
https://reports.collegeboard.org/archive/sat-suite-program-results/2017/detailed-2017-reports

1. open original sat data file (csv) in excel
	- notice warning at top
	- file > save as > xlsx format (keeps all our changes
	  we're about to make)
	- maybe note in filename "cleaned"

2. basic cleanup
	- click col a header (down arrow)
		- format > column > autofit width
		- sel multiple and do that for other cols too
	- notice how data is already a bit messy
		- school names variously listed, etc

	- rename headers to be nicer
		- mostly get rid of _
		- READING/WRITING
		- AVERAGE TOTAL SCORE
		- can make them bold too

	- make district names all caps
		- note that some are all caps, some not
		- click "f" col name at top
		- right-click > insert
		- in first cell below header, type =UPPER() then click cell next to it
		- case should be converted
		- double-click the little box in the lower-right corner to paste all
		  the way down the column
		- select all new cells, copy
		- in old column's first cell, edit > paste special...
		- select 'values' and ok
		- click 'f' header of new column, right click > delete
	- do the same thing for school names

	- at this point we'd probably have to manually check to see if there are any
	  schools that are duplicated but spelled differently (same with districts)
	  but we'll skip that for now

2. explore
	- add filter option
		- select header cells
		- data > auto filter (or cmd+shift+f)
		- might want to auto-fit again
		- click little arrow on header to try filtering
			- asc and desc opts
		- note all data moves with it (but only if that
		  col has filtering on too!)
		- try seeing which school has the highest math
			- read/write?
			- total?
		- a great, simple way of exploring the data


3. formulate a question
	- how does each school compare with the national average?
		- find more data!
		- look for same year, if possible
		- https://reports.collegeboard.org/archive/sat-suite-program-results/2017/class-2017-results
		- add new col on right
			- title US MEAN TOTAL SCORE
			- add data, double-click to copy down
		- a final new col: DIVERGENCE FROM US MEAN
			- add formula =<state mean> - <us mean>
			- positive #s = above the us average, - = below
		- make this col sortable...
			- sort by divergence
		- asc tells one story (lowest-performing), desc another (highest)

	- do a quick visualization!
		- sel divergence and dist cols
		- insert > chart > column (bar chart)...
		- expand in size to view better
			- still really hard to see, since there are so many
			- but overall visual is pretty interesting!
		- try sel first 30 schools instead
			- bar chart again

	- a simpler but more stats question
		- how many schools are better at reading/writing than math?
		- new col = BETTER AT READING?
		- formula: =IF(<avg reading> > <avg math>, "YES", "NO")
		- double-click box to paste down
		- to count, in another single cell...
			- formula: =COUNTIF(<range>, "YES")
		- do again for NO
		- create total # schools cell
		- then % better at reading:
			- formula: reading/total
			- change cell type to %

4. combine some data
	- open nj state aid spreadsheet
	- notice lots of other formatting stuff
		- and cols we might or might not want to explore later

	- how much total state aid given?
		- new cell, label
		- next to it: =SUM(C:C)
		- format as $
	- what % does each district get?
		- new column
		- formula: =<aid rec> / I2
			- notice error!
			- trying to ref cells going down
			- instead: =<aid rec> / $I$2
				- $ means absolute ref
		- change to percent
		- increase decimal places
	- make a vis!
		- select aid and district cols
		- insert > chart > pie...
		- too many points here, try sorting and limiting
		  to the schools receiving the most aid
		- still needs some love, but super helpful for playing
		  and experimenting

	- sheet in our first doc
		- little plus icon
		- rename if you want
	- copy/paste dist names, codes, and "total state aid 2016-17"
	- in first cell, type formula: =INDEX('NJ State Aid'!C:C, MATCH(F2, 'NJ State Aid'!A:A, 0))
		- MATCH(<looking for>, <range to search>, <search type>)
			- 0 search type means find first match, in case there are duplicates
		- INDEX(<value from this range>, <position in that range to get>)
		- essentially matches the districts and grabs the state aid value
	- double-click down
	- format column as $
	- note some #N/As!
		- means the school district wasn't found
		- possibly because of diff spellings
		- or charter schools (that don't receive state aid)
		- or missing data

5. add title and citation
	- insert some rows at top
	- title, byline
	- urls to all data sources
	- upload to google sheet or start there first


















